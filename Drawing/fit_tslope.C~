void setstyle(TH1D *histo, TF1 *fithisto, TPaveText *ptw)
{

    histo->SetMarkerSize(0.5);
    histo->SetMarkerStyle(20);
    histo->SetTitleOffset(0.9,"X");
    histo->SetTitleSize(0.05,"X");
    histo->SetTitleOffset(1.2,"Y");
    histo->SetTitleSize(0.04,"Y"); 
    histo->SetLineColor(kBlue);
    histo->SetMarkerColor(kBlue);
    histo->SetLineWidth(1);    

    histo->GetYaxis()->SetTitle("");//Events/ 0.02 [GeV^{2}]");
    histo->GetXaxis()->SetTitle("-Q^{2}  [GeV^{2}]");

    fithisto->SetLineColor(kRed);
    fithisto->SetLineWidth(3);

    ptw->SetTextSize(0.04);
    ptw->SetBorderSize(0);
    ptw->SetBorderSize(2);
    ptw->SetFillColor(kGray);
      
 }




void fit_tslope()
{

  const char *filename = "../saved_histos/histos_data_spring2017.root";
  char *pavetext1 = new char[20];
  char *pavetext2 = new char[20];

  
   TFile *file = TFile::Open(filename,"READ");
   if (!file) return;


    TH1D *tslope1 = (TH1D*)file->TFile::Get("minustvar1");
    TH1D *tslope2 = (TH1D*)file->TFile::Get("minustvar2");

    Double_t lval1=tslope1->GetXaxis()->GetBinCenter(tslope1->GetMaximumBin());
    Double_t lval2=tslope2->GetXaxis()->GetBinCenter(tslope2->GetMaximumBin());
    Double_t rval1=1.5, rval2=1.5;

    
    std::cout << "Max val = " << lval1 << "  " << lval2 << endl;


    TF1 *fit_tslope1 = new TF1("h01","[0]*exp(-[1]*x)",1.0,1.3);
    TF1 *fit_tslope2 = new TF1("h02","[0]*exp(-[1]*x)",0.9,1.5);

    tslope1->Fit(fit_tslope1,"R");
    tslope2->Fit(fit_tslope2,"R");

    
    sprintf(pavetext1,"~ exp(-%.2f*x)",fit_tslope1->GetParameter(1));
    sprintf(pavetext2,"~ exp(-%.2f*x)",fit_tslope2->GetParameter(1));


    
    // Drawing in the rest of this macro 

    TPaveText *ptw1 = new TPaveText(0.7,0.65,0.89,0.75,"NDC");
    TPaveText *ptw2 = new TPaveText(0.7,0.65,0.89,0.75,"NDC");
    ptw1->AddText("Bin width = 0.02\n");
    ptw1->AddText(pavetext1);
    ptw2->AddText("Bin width = 0.02\n");
    ptw2->AddText(pavetext2);
    

    setstyle(tslope1,fit_tslope1,ptw1);
    setstyle(tslope2,fit_tslope2,ptw2);
    gStyle->SetOptStat(0);

    
    TCanvas* canva = new TCanvas("c2","c2",15,10,700,250);
    canva->Divide(2,1);

      canva->cd(1);
      tslope1->Draw("HIST");
      fit_tslope1->Draw("SAME");  
      ptw1->Draw("SAME");
      canva->cd(2);
      tslope2->Draw("HIST");
      fit_tslope2->Draw("SAME");
      ptw2->Draw("SAME");
      
      canva->Print("tslope_fit.pdf", "pdf");
      canva->Close();
    
      

    file->Close();

}
